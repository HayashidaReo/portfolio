# 概要

日本拳法の大会運営を包括的に支援する、リアルタイム・スコアリングWebアプリケーションです。Presentation APIを活用した試合会場の**リアルタイム得点板**機能に加え、**選手登録フォーム**、**試合組み合わせの自動生成**、**戦績管理**まで、大会運営のワークフローを一気通貫でDX化することを目指します。

---
# 開発背景

知人（友人）が主催する日本拳法の大会において、既存の得点板システムや紙ベースの運営が非効率で使いにくいという課題をヒアリングしたことがきっかけです。当初は得点板の作成依頼でしたが、ヒアリングを深める中で　**「運営の負担軽減」**　と　**「観戦体験の向上」** という本質的なニーズを特定し、単なる得点板に留まらない総合的な大会支援システムとして企画・開発を開始しました。

---
# 主な機能

* **リアルタイム・スコアボード**
    * Presentation API（またはBroadcast API）と連携し、操作画面とは別のモニターに得点、反則、タイマーを遅延なくリアルタイム表示。
* **試合操作ダッシュボード**
    * 得点・反則（ルール自動連動）・タイマーを直感的に操作できる管理者用画面。
* **参加者管理ワークフロー**
    * 公開型の**選手登録フォーム**と、送信内容を管理者が承認・編集できる**選手管理画面**を連携。
* **メール自動送信 (Cloud Functions + SendGrid)**
    * 選手登録フォーム送信時、申請者へ確認メールを自動で送信。
* **試合組み合わせ作成機能**
    * 承認済みの選手データに基づき、大会の対戦カードを作成・管理。
* **マルチテナント・大会管理機能**
    * 複数の団体（組織）が、それぞれ複数の大会（例：A大会は本戦、B大会は新人戦）を並行して管理できるシステム基盤を構築。

---
# 技術選定の理由

* **バックエンド (Firebase)**
    * サーバーレスアーキテクチャによる**開発工数と運用コストの圧縮**、およびFirestoreによる**リアルタイム性**の担保のため。
* **フロントエンド (React / Next.js)**
    * Webアプリとしての高速な動作、SEO、豊富なエコシステムを評価し採用しました。当初検討したFlutter (Web)と比較し、WebプラットフォームにおけるパフォーマンスとDOM操作の柔軟性で優位と判断しました。
* **リアルタイム表示 (Presentation API / Broadcast API)**
    * 当初、Firestoreのリアルタイムリスナーでの得点板連携を検討しましたが、**①通信ラグ**、**②オフライン環境での動作不安定性**という課題に直面しました。
    * 解決策として、ブラウザ標準機能である **Presentation API** を採用。これにより、通信を介さずセカンドスクリーンに直接描画するため、遅延ゼロのリアルタイム性を実現しました。
    * さらに、外部モニターが接続されていない開発環境や、PC1台での簡易運用も想定し、Presentation APIが使えない場合は **Broadcast API** を使用して別タブに表示する**フォールバック機能**も実装しました。

---
# このプロジェクトが解決を目指す課題

### 最終的なビジョン
このシステムの最終的なビジョンは、**「日本拳法コミュニティ全体をデータとデジタル技術によって活気付ける」** ことです。


## システムが提供する価値

1.  **【運営者】 大会運営のDX化と標準化**
    * 紙やExcelでの組み合わせ作成、手動での集計といった煩雑な作業を撤廃し、**運営の属人化を防ぎます**。システムがミスのない効率的な大会進行をサポートします。
2.  **【観客】 新しい観戦体験の創出**
    * リアルタイムなスコアボード表示により、試合の状況が瞬時に伝わるワクワクする観戦体験を提供します。


## 今後の展望（ロードマップ）

上記のビジョンを実現するため、現在の中核機能（リアルタイムスコアボード、選手管理）を作成中です。中核機能が完成してからは、以下の機能開発を計画しています。

* **戦績集計ダッシュボードの実装**
    * 選手個人やチームの戦績（勝敗、得点詳細）を集計・可視化する機能です。これを実装することで、上記 **2.【選手】への価値提供** を実現します。
* **多様な試合形式への対応（自動化）**
    * 現在の手動での組み合わせ作成機能に加え、団体戦、トーナメント戦、リーグ戦など、複雑な試合形式のロジックに対応した自動生成・管理機能を追加します。
* **スマートフォンへの最適化**
    * 運営者がPCだけでなく手元のスマートフォンからもスコアボード操作にアクセスできるよう、レスポンシブ対応を進めます。

---
# 技術的なこだわりと工夫

* **スケーラビリティを考慮したマルチテナントDB設計**
    * 依頼者個人の利用に留まらず、将来的に「日本拳法全体に普及させたい」という展望を実現するため、システム設計の初期段階からマルチテナント（複数組織での利用）に対応しました。
    * `organizations` ▷ `tournaments` ▷ `matches` という階層構造を採用し、組織（団体）ごとに独立して複数の大会を管理できるDB設計にしています。これにより、A大会の試合を運営しながら、B大会の選手登録を受け付ける、といった並行管理を可能にしました。
* **通信環境に依存しない堅牢な状態管理**
    * 大会会場の不安定な通信環境を前提とし、試合中のスコアやタイマー操作はすべて**Reactのローローカルステート（またはZustand）のみで完結**させています。
    * 得点板への反映は（Presentation API経由で）即座に行い、データベース (Firebase) への書き込みは「試合終了」ボタン押下時の一度きりにすることで、試合進行のリアルタイム性とシステムの安定性を両立させました。
* **運用負荷を軽減する自動化処理 (Cloud Functions)**
    * 選手管理において、「チーム内で同姓の選手がいた場合、表示名を自動で『姓＋名（の一部）』に変更する」といった細かな運用ルールをCloud Functionsで自動化し、管理者の手動によるミスや負担を削減しています。