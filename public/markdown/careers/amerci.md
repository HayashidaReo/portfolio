# はじめに

## バイト先について

厳選された食品や雑貨を販売する個人営業のセレクトショップです。ここでは、業務の基盤としてExcelとVBAで構築されたレジ・在庫管理システムが使われていました。

## 改善のきっかけ

2022年12月から接客、レジ、納品など幅広い業務を担当するスタッフとして働き始めました。業務を遂行する中で非効率な点に気づき、これを改善したいという思いからオーナーに提案し、システムの改良に着手しました。

---
# 具体的な改良事例

## 1. 発注書作成の半自動化

### 概要

レジ内の商品情報を活用し、必要な商品を選択するだけで発注書を自動作成・PDF化し、取引先へメール送信するシステムです。

### 使用技術

* VBA
* Excel関数
* Outlook

### 従来の問題点

手作業でWordに発注情報を入力し、金額も手計算で行っていたため、入力ミスや計算ミスが頻発していました。そして発行後に、手動でPDF変換とメール送信を行うため、多くの時間と手間がかかっていました。

### 改良点

* 商品選択と個数入力のみで発注書が自動作成され、手作業を大幅に削減。
* 作成した発注書のPDF化と取引先へのメール送信を自動化し、作業を効率化。
* 発注商品を自動で納品待機リストに登録することで、納品時の作業負担を軽減。

## 2. QRコードシール発行の全自動化

### 概要

納品された商品に貼るQRコードシールの発行作業を、Pythonを用いて全自動化するプログラムです。

### 使用技術

* VBA
* Python (PyAutoGUI)

### 従来の問題点

納品作業には冷蔵物もあるため迅速性が求められますが、従来は以下の手動ステップが多く、約3分かかっていました。

1.  レジ・在庫管理システムで納品商品の情報をCSVファイルとして作成
2.  CSVファイルをシール発行ソフト（P-touch）に手動でインポート
3.  各種設定を手動で行いシールを発行

特にステップ2と3で多くの選択・入力項目があり、時間短縮が課題でした。

### 改良点

* CSVファイル作成後、残りのインポートと設定・発行作業を全自動化。
* 手作業で約3分かかっていたシール発行作業を**約30秒に短縮**し、作業効率を大幅に向上。


## 3. BASE在庫数更新の自動化

レジ・在庫管理システムの在庫情報を、ネットショップ「BASE」へ自動的に反映させるシステムです。
2段階に分けて自動化・改善を行いました。


### **フェーズ1：VBAによる半自動化システムの構築**

#### 概要

まず、レジ・在庫管理システム（Excel/VBA）からBASEにアップロードするためのCSVファイルを自動生成する仕組みを構築しました。

#### 使用技術

* VBA
* Excel関数

#### 従来の問題点

全商品をBASEで販売して売上を最大化するには、正確な在庫数を反映させる必要がありました。しかし、手動での在庫管理は時間がかかり、計算ミスや更新漏れのリスクが高く、結果として在庫に余裕のある一部商品しか出品できていませんでした。

#### 改良点と成果

* VBAを用いて、商品IDと賞味期限に基づいた適切な在庫数を自動計算し、CSVファイルとして出力するロジックを構築。
* 賞味期限が近い商品の販売停止や割引フラグの管理も自動化し、在庫管理の精度を向上。
* これにより、手動でのデータ入力と計算作業が大幅に削減され、より多くの商品をBASEに出品可能に。

#### 残された課題

この段階ではCSVファイルのBASEへのインポートは手動で行う必要がありました。また、複雑なロジックをVBAとExcel関数で実装したためコードの保守性が低く、更新も1日1回が限界でした。そのため、実店舗で商品が売れた際に在庫のズレが生じ、BASE上で在庫不足が発生するリスクが残っていました。


### **フェーズ2：PythonとBASE APIによる全自動化システムの実現**

#### 概要

フェーズ1で残った課題を解決するため、PythonとBASE APIを活用した完全自動の在庫連携システムを構築しました。

#### 使用技術

* Python
* BASE API
* VBA

#### 改良点と成果

##### 完全自動化の実現
在庫システムからのデータ抽出はVBAで行い、その後の複雑な計算処理（在庫数、割引タグなど）とBASEへのデータ反映は、すべてPythonとBASE APIを介して自動で行うようにしました。これにより、手動でのインポート作業が完全に不要になりました。

##### 在庫連携のリアルタイム化
APIを直接利用することで、より頻繁な在庫更新が可能になり、実店舗とBASE間での在庫差異を最小限に抑え、在庫不足による販売機会の損失リスクを大幅に低減しました。

##### 保守性の向上
Excel/VBAに依存していた複雑なロジックをPythonに移行したことで、コードの可読性と保守性が格段に向上し、将来的な仕様変更にも対応しやすい設計となりました。

---
## 4. 賞味期限管理画面の作成・自動割引適用

### 概要

賞味期限管理画面を作成し、割引設定された商品の可視化と割引処理の自動適用を実現するシステムです。

{{stockManager|medium|賞味期限管理画面}}

### 使用技術

* VBA

### 従来の問題点

在庫画面で賞味期限をフィルターして手動でチェックしていたため、以下の問題が発生していました。

1.  **チェック漏れ:** 手動作業により、期限の近い商品を見落とす可能性が高かった。
2.  **割引処理の不透明さ:** 割引シールの有無がシステム上で分からず、レジでの割引処理が手動となり、処理漏れや期限切れ商品の回収忘れが発生することがあった。

### 改良点

* 各商品の割引開始期間を事前に設定。毎日自動で割引開始商品を洗い出し、一覧で表示する画面を作成。
* レジでの割引処理をシステムに自動適用するように修正。手動での処理が不要となり、作業時間の短縮とエラーの減少を実現。